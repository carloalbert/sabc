##This is example 1 in Albert et al.

y <- 0.1
n.sample <- 200
eps.init <- 2
iter.max <- 1000
v <- 0.001
beta <- 2
resample <- 3*n.sample
delta <- 0.1
method <- "informative"
adaptjump <- TRUE
summarystats <- FALSE
f.summarystats <- NULL

##prior is uniform on [-10,10]
d.prior <- function(par)
    return(dnorm(par,0,1))

r.prior <- function()
    return(rnorm(1,0,1))

##Model is sum of two normal random variables
r.model <- function(par)
    return( rnorm( 1 , 2*par , 1+0.01 ) )



##run SABC
source("../SABC/R/SABC.R")
source("../SABC/R/SABC.inf.r")
SABC.res <- SABC(
  r.model       = r.model,
  r.prior       = r.prior,
  d.prior       = d.prior,
  n.sample      = n.sample,
  eps.init      = eps.init,
  iter.max      = iter.max,
  v             = v,
  beta          = beta,
  delta         = delta,
  resample      = resample,
  verbose       = n.sample,
  method        = method,
  adaptjump     = adaptjump,
  summarystats  = summarystats,
  y             = y,
  f.summarystats = f.summarystats)

##draw histogramm
hist(SABC.res$E,prob=TRUE,breaks=20,xlim=c(-5,5),col=rgb(1,0,0,1/4))

